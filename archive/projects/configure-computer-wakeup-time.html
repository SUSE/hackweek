<head>
  <title>
    SUSE Hack Week - Past Project
  </title>
  <link href='../../images/favicon.gif' rel='shortcut icon' />
  <link href='../../css/hackweek-single-page.css' rel='stylesheet' type='text/css' />
</head>
<body>
  <div id='navigation'>
    <li class='logo invert' id='start-link'>
      <a href='../../index.html'>
        <img border='0' height='52' src='../../images/px.gif' width='112' />
      </a>
    </li>
    <li class='invert' id='what-is-link'>
      <a href='../../index.html#what-is'>
        what is hack week?
      </a>
    </li>
    <li class='invert' id='agenda-link'>
      <a href='../../index.html#agenda'>
        agenda
      </a>
    </li>
    <li class='invert' id='projects-link'>
      <a href='../../index.html#projects'>
        projects
      </a>
    </li>
    <li class='invert' id='where-link'>
      <a href='../../index.html#where'>
        where?
      </a>
    </li>
  </div>
  <div id='content'>
    <div id='wrapper'>
      <div id='wrapper-title'>
        <h1></h1>
      </div>
      <div id='wrapper-content'>
        <p><b>Tags:</b> InProgress, HelpWanted, LowPower, Desktop, hardware, judgepower</p>
        <h2>Configure-Computer-Wakeup-Time - Description</h2>
        <p>I would like to be able to set the wakeup time/date of the computer in the shutdown/suspend dialogue.
        Many people leave their Office PC running at night because they don't want to wait 
        until it started up in the morning. If they could use this idea in an easy way, it would 
        save lots of wasted energy of office workstations. </p>
        <ul>
        <li>**It seems that most notebook BIOS lack the feature of wakeup time... :-(**</li>
        </ul>
        <p>Technically, there are three methods to achieve this: </p>
        <ul>
        <li>Write wakeup time to ''/proc/acpi/alarm''</li>
        <li>nvram-wakeup: writes directly to BIOS nvram, hardware dependant.</li>
        <li>"Settime": Having a fixed wakeup time in the BIOS, and set the system time on shutdown accordingly to the configured wakeup time. </li>
        </ul>
        <p>Notes for ACPI wakeup: </p>
        <ul>
        <li>Kernel needs to be compiled with ''CONFIG_ACPI_SLEEP_PROC_FS=y''</li>
        <li>Sysconfig (/etc/sysconfig/clock) ''SYSTOHC = no'' has to be set. (BIOS resets wakeup time when clock is written on shutdown)</li>
        <li>Easy way to set offset wakeup time: ''echo "+00-00-00 00:05:00" > /proc/acpi/alarm''</li>
        <li>Wakeup function has to be **disabled** in BIOS</li>
        </ul>
        <p>Notes for HAL integration: </p>
        <ul>
        <li>Include into suspend script: ''/usr/lib/hal/scripts/linux/hal-system-power-suspend-linux''</li>
        </ul>
        <p>Notes for Kernel >= 2.6.22 </p>
        <ul>
        <li>''/proc/acpi/alarm'' is no more avalable', replaced by ''/sys/class/rtc/rtc0/wakealarm''</li>
        <li>This file takes seconds since epoch as input (for example: ''date -d "Jun 26 13:00" "+%s"'', reverse: ''date -d @<seconds>'')</li>
        <li>To set a new value, it needs a reset: ''echo 0 > /sys/class/rtc/rtc0/wakealarm''</li>
        </ul>
        <p>Issues: </p>
        <ul>
        <li>Kernel needs to be compiled with unset ''CONFIG_RTC'' and ''CONFIG_GEN_RTC'' to have ''/sys/class/rtc/rtc0/wakealarm'' available (needs to be recompiled for openSUSE 10.3)</li>
        <li>There seems to be a bug: ''echo 1182948552 > /sys/class/rtc/rtc0/wakealarm; cat /sys/class/rtc/rtc0/wakealarm'' returns 2051637448. There is a non-constant offset, maybe due to the BIOS not storing the century? (http://lkml.org/lkml/2007/6/19/264)</li>
        <li>/sys/class/rtc/rtc0/wakealarm seems to only accept times > 2h in the future</li>
        </ul>
        <h2>People</h2>
        <p>Thomas Schmidt originated this idea and will be working on it. </p>
        <p>Any help or hints for integration in kpowersave, HAL... would be nice, 
        because this is an unknown area to me. </p>
        <h2>Related Materials</h2>
        <p>This idea is inspired by a c't article in 11/2007, page 206ff 
        (http://www.heise.de/ct/07/11/links/206.shtml)</p>
        <p>ACPI alarm doc: http://acpi.sourceforge.net/documentation/alarm.html</p>
        <p>ACPI wakeup in mythtv: http://www.mythtv.org/wiki/index.php/ACPI_Wakeup</p>
        <p>HAL specification: http://people.freedesktop.org/~david/hal-spec/hal-spec.html</p>
        <p>Linux Magazine article: http://www.linux-magazine.com/issue/46/Wakeup_Call_For_Computers.pdf</p>
      </div>
    </div>
  </div>
</body>
